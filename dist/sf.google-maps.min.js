/*!
 * Google Maps wrapper for Spiral and sf.js v0.2.0
 * https://github.com/spiral-modules/google-maps/
 * Copyright (c) 2016, Alex Chepura, spiralscout.com
 */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("sf"));else if("function"==typeof define&&define.amd)define(["sf"],e);else{var o=e("object"==typeof exports?require("sf"):t.sf);for(var n in o)("object"==typeof exports?exports:t)[n]=o[n]}}(this,function(t){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var i=o(1),r=n(i),s=o(2),a=n(s);o(3),r["default"].registerInstanceType(a["default"],"js-sf-google-maps"),t.exports=a["default"]},function(e,o){e.exports=t},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var i=o(1),r=n(i),s=function(t,e,o){this._construct(t,e,o)};s.prototype=r["default"].createModulePrototype(),s.prototype.name="gmaps",s.prototype._construct=function(t,e,o){this.init(t,e,o);var n=this;this.addMultipleMapsBinded=this.addMultipleMaps.bind(this),this._key?this.addMultipleMapsBinded():(s.prototype._key=this.options.key,this.importScript("https://maps.googleapis.com/maps/api/js?key="+this.options.key+(this.options.search?"&libraries=places":""),function(){n.initMaps()})),this.form||!this.options.nameLat&&!this.options.nameLng||(this.form=this.sf.helpers.domTools.closest(this.node,"form")),(this.options.marker||this.options.markerLat||this.options.markerLng)&&(this.options.marker=!0)},s.prototype._key="",s.prototype.addMultipleMaps=function(){"undefined"!=typeof google?this.initMaps():setTimeout(this.addMultipleMapsBinded,1e3)};var a=function(t,e,o){return e?("string"==typeof e&&(e=parseFloat(e)),e):o.value};s.prototype.optionsToGrab={nameLat:{domAttr:"data-name-lat"},nameLng:{domAttr:"data-name-lng"},key:{domAttr:"data-key"},zoom:{value:13,domAttr:"data-zoom",processor:a},lat:{value:0,domAttr:"data-lat",processor:a},lng:{value:0,domAttr:"data-lng",processor:a},marker:{domAttr:"data-marker"},editable:{domAttr:"data-editable",processor:function(t,e){return"true"===e||e===!0}},markerLat:{value:!1,domAttr:"data-marker-lat",processor:a},markerLng:{value:!1,domAttr:"data-marker-lng",processor:a},form:{domAttr:"data-form",processor:function(t,e){this.form=e?document.querySelectorAll(e)[0]:!1}},search:{domAttr:"data-search",processor:function(t,e){return e="true"===e||e===!0}}},s.prototype.importScript=function(t,e){function o(t){throw new URIError("The script "+t.target.src+" is not accessible.")}var n=document.createElement("script");n.type="text/javascript",n.onerror=o,e&&(n.onload=e),document.head.appendChild(n),n.src=t},s.prototype.initMaps=function(){var t=this;if(this.map=new google.maps.Map(this.node,{zoom:this.options.zoom,center:{lat:this.options.lat,lng:this.options.lng}}),this.options.marker&&(this.marker=new google.maps.Marker({map:this.map,draggable:this.options.editable,position:{lat:this.options.markerLat!==!1?this.options.markerLat:this.options.lat,lng:this.options.markerLng!==!1?this.options.markerLng:this.options.lng}}),this.options.editable&&google.maps.event.addListener(this.marker,"dragend",this.saveMarkerCoordinates.bind(this)),this.saveMarkerCoordinates()),this.options.search){this.inputSearch=document.createElement("input"),this.inputSearch.type="text",this.inputSearch.className="pac-input gm-control",this.inputSearch.addEventListener("keydown",function(t){return 13===t.keyCode?(t.preventDefault(),!1):void 0}),this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(this.inputSearch),this.marker&&(this.btnMarkPlace=document.createElement("div"),this.btnMarkPlace.className="gm-control gm-button",this.btnMarkPlace.textContent="Mark",this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(this.btnMarkPlace),this.btnMarkPlace.addEventListener("click",function(){var e=t.placeMarker.getVisible()?t.placeMarker.getPosition():t.map.getCenter();t.marker.setPosition(e),t.saveMarkerCoordinates()})),this.autocomplete=new google.maps.places.Autocomplete(this.inputSearch),this.autocomplete.bindTo("bounds",this.map),this.autocomplete.setTypes([]),this.infowindow=new google.maps.InfoWindow;var e=new google.maps.Marker({map:this.map,anchorPoint:new google.maps.Point(0,-29),visible:!1});this.placeMarker=e,this.autocomplete.addListener("place_changed",function(){t.infowindow.close(),e.setVisible(!1);var o=t.autocomplete.getPlace();if(o.geometry){o.geometry.viewport?t.map.fitBounds(o.geometry.viewport):(t.map.setCenter(o.geometry.location),t.map.setZoom(17)),e.setIcon({url:o.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)}),e.setPosition(o.geometry.location),e.setVisible(!0);var n="";o.address_components&&(n=[o.address_components[0]&&o.address_components[0].short_name||"",o.address_components[1]&&o.address_components[1].short_name||"",o.address_components[2]&&o.address_components[2].short_name||""].join(" ")),t.infowindow.setContent("<div><strong>"+o.name+"</strong><br>"+n),t.infowindow.open(t.map,e)}})}this.map.addListener("click",function(e){t.marker.setPosition(e.latLng),t.saveMarkerCoordinates()}),this.node.offsetHeight||(this.onHashChangeBinded=this.onHashChange.bind(this),window.addEventListener("hashchange",this.onHashChangeBinded,!1))},s.prototype.onHashChange=function(){this.node.offsetHeight&&(google.maps.event.trigger(this.map,"resize"),this.map.setCenter({lat:this.options.lat,lng:this.options.lng}),window.removeEventListener("hashchange",this.onHashChangeBinded))},s.prototype.saveMarkerCoordinates=function(){var t=this.marker.getPosition();this.markerLat=t.lat(),this.markerLng=t.lng(),this.form&&(this.inputLat||(this.inputLat=document.createElement("input"),this.inputLat.type="hidden",this.inputLat.name=this.options.nameLat,this.form.appendChild(this.inputLat)),this.inputLng||(this.inputLng=document.createElement("input"),this.inputLng.type="hidden",this.inputLng.name=this.options.nameLng,this.form.appendChild(this.inputLng)),this.inputLat.value=this.markerLat,this.inputLng.value=this.markerLng)},s.prototype.die=function(){},e["default"]=s},function(t,e,o){var n=o(4);"string"==typeof n&&(n=[[t.id,n,""]]);o(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,o){e=t.exports=o(5)(),e.push([t.id,".js-sf-google-maps{line-height:normal}.gm-control,input.gm-control{font-family:Roboto,Arial;margin:10px 0 0;padding:8px;border:0;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;outline:none;box-shadow:rgba(0,0,0,.3) 0 1px 4px -1px}.gm-control.hide,input.gm-control.hide{display:none}.gm-button{background-color:#fff;cursor:pointer;color:#565656;padding:8px;font-size:11px;margin-left:10px}.gm-button:hover{background-color:#ebebeb}input.pac-input{background-color:#fff;font-size:11px;font-weight:300;text-overflow:ellipsis;width:305px;max-width:calc(100% - 173px);line-height:normal}input.pac-input:focus:not([readonly]){border:0;box-shadow:rgba(0,0,0,.3) 0 1px 4px -1px}",""])},function(t,e){"use strict";t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var o=this[e];o[2]?t.push("@media "+o[2]+"{"+o[1]+"}"):t.push(o[1])}return t.join("")},t.i=function(e,o){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(n[r]=!0)}for(i=0;i<e.length;i++){var s=e[i];"number"==typeof s[0]&&n[s[0]]||(o&&!s[2]?s[2]=o:o&&(s[2]="("+s[2]+") and ("+o+")"),t.push(s))}},t}},function(t,e,o){function n(t,e){for(var o=0;o<t.length;o++){var n=t[o],i=h[n.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](n.parts[r]);for(;r<n.parts.length;r++)i.parts.push(d(n.parts[r],e))}else{for(var s=[],r=0;r<n.parts.length;r++)s.push(d(n.parts[r],e));h[n.id]={id:n.id,refs:1,parts:s}}}}function i(t){for(var e=[],o={},n=0;n<t.length;n++){var i=t[n],r=i[0],s=i[1],a=i[2],p=i[3],d={css:s,media:a,sourceMap:p};o[r]?o[r].parts.push(d):e.push(o[r]={id:r,parts:[d]})}return e}function r(t,e){var o=g(),n=y[y.length-1];if("top"===t.insertAt)n?n.nextSibling?o.insertBefore(e,n.nextSibling):o.appendChild(e):o.insertBefore(e,o.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");o.appendChild(e)}}function s(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",r(t,e),e}function p(t){var e=document.createElement("link");return e.rel="stylesheet",r(t,e),e}function d(t,e){var o,n,i;if(e.singleton){var r=b++;o=v||(v=a(e)),n=l.bind(null,o,r,!1),i=l.bind(null,o,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=p(e),n=u.bind(null,o),i=function(){s(o),o.href&&URL.revokeObjectURL(o.href)}):(o=a(e),n=c.bind(null,o),i=function(){s(o)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}function l(t,e,o,n){var i=o?"":n.css;if(t.styleSheet)t.styleSheet.cssText=k(e,i);else{var r=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(r,s[e]):t.appendChild(r)}}function c(t,e){var o=e.css,n=e.media;e.sourceMap;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}function u(t,e){var o=e.css,n=(e.media,e.sourceMap);n&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var i=new Blob([o],{type:"text/css"}),r=t.href;t.href=URL.createObjectURL(i),r&&URL.revokeObjectURL(r)}var h={},m=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},f=m(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=m(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=f()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var o=i(t);return n(o,e),function(t){for(var r=[],s=0;s<o.length;s++){var a=o[s],p=h[a.id];p.refs--,r.push(p)}if(t){var d=i(t);n(d,e)}for(var s=0;s<r.length;s++){var p=r[s];if(0===p.refs){for(var l=0;l<p.parts.length;l++)p.parts[l]();delete h[p.id]}}}};var k=function(){var t=[];return function(e,o){return t[e]=o,t.filter(Boolean).join("\n")}}()}])});
//# sourceMappingURL=sf.google-maps.min.js.map